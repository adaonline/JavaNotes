# 一.类的加载连接初始化

## 1.1 JVM和类
当运行某个程序的时候，会启动一个java进程。同一个jvm的所有线程，所有变量都处于同一个进程里，他们都使用这个JVM进程的内存区。JVM终止的条件：
- 程序正常运行结束
- 程序运行到System.exit()或者Runtime.getRuntime().exit()结束程序
- 程序执行过程中遇到没有捕获的异常或者错误
- 程序所在的操作系统还有平台，结束了JVM

## 1.2 类的加载
使用某个类的时候，类没有被加载带内存中，就需要经过加载，连接，初始化三个步骤来进行初始化。称为类加载或者初始化。

将类的class文件读入内存，并且创建一个java.lang.class对象，也就是说，程序中使用任何类的时候，系统都会给其建立一个java.lang.class对象。

类加载由加载器完成。jvm的加载器叫系统类加载器，还可以继承ClassLoader基类来创建自己的类加载器。

## 1.3 类的连接
类加载后，会生成class对象，进入连接阶段
- 验证类的结构是否正确
- 为类变量分配内存，设置初始值
- 符号引用替换成直接引用

## 1.4 初始化
虚拟机对类进行初始化，主要是对类变量初始化
- 声明类变量时候指定初始值
- 使用静态初始化块为类变量指定初始值

JVM初始化一个类有如下几个步骤：
1. 这个类还没有被加载和连接，先加载连接
2. 如果这个类的直接父类没有被初始化，则先初始化父类(父类也要判断父类的父类)
3. 如果类中有初始化语句，则依次执行初始化语句

类什么时候进行初始化：

- 创建类的实例
- 调用某个类的类方法，也就是静态方法
- 访问某个类或者接口的类变量
- 使用反射方法来强制创建某个类或者接口的class对象
- 初始化某个类的子类
- 直接用java.exe来运行某个类